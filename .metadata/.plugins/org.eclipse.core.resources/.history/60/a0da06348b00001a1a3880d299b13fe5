import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class TestUserDAO {

	String name = "";
	String password = "";
	public void select(String name,String password){

		//DB接続の準備。DBと会話するためのｺｰﾄﾞ
		DBConnector db = new DBConnector();
		Connection con = db.getConnection();

		//test_tableに入っているﾃﾞｰﾀuser_name=? password=?に入る２つの条件を満たしたﾃﾞｰﾀがsqlに代入される
		//?はﾌﾟﾚｰｽﾎﾙﾀﾞ(その都度違うﾃﾞｰﾀを入れたい場合に使用する)
		String sql = "select*from test_table where user_name=? and password=?";


		try{
			//PreparedStatementはDBまで運んでくれる箱
			PreparedStatement ps = con.prepareStatement(sql);
			ps.setString(1,name);
			ps.setString(2, password);

			//executeQuery()は実行ﾒｿｯﾄﾞ。必ずResultSetが返ってくる
			ResultSet rs = ps.executeQuery();
			if(rs.next()){

				//下記２つのことを行っている
				//DBConnectorを下に一行ずらすこと。
				//ﾃﾞｰﾀが存在していれば戻り値をtrueで返す。存在しなければfalseで返す。
				System.out.println(rs.getString("user_name"));
				System.out.println(rs.getString("password"));
			}
		}catch(SQLException e){
			e.printStackTrace();
		}
		try{
			//DBとの接続を終了させるという意味。終了時には必ず！
			con.close();
		}catch(SQLException e){
			e.printStackTrace();
		}
	}
	public void selectAll(){
		DBConnector db = new DBConnector();
		Connection con = db.getConnection();

		String sql = "select*from test_table";
		try{
			PreparedStatement ps = con.prepareStatement(sql);
			ResultSet rs = ps.executeQuery();
			//while(rs.next())はｶｰｿﾙを１行ずつ実行して、ﾃﾞｰﾀがなくなったら実行を終了
			while(rs.next()){
				System.out.println(rs.getString("user_name"));
				System.out.println(rs.getNString("password"));
			}
		}catch(SQLException e){
			e.printStackTrace();
		}try{
			con.close();
		}catch(SQLException e){
			e.printStackTrace();
		}
	}
	public void selectByName(String name){
		DBConnector db = new DBConnector();
		Connection con = db.getConnection();

		String sql = "select*from test_table where user_name=?";
		try{
			PreparedStatement ps = con.prepareStatement(sql);
			ps.setString(1, name);
			ResultSet rs = ps.executeQuery();
			while(rs.next()){
				System.out.println(rs.getString("user_name"));
				System.out.println(rs.getString("password"));
			}
		}catch(SQLException e){
			e.printStackTrace();
		}
		try{
			con.close();
		}catch(SQLException e){
			e.printStackTrace();
		}
	}
}
